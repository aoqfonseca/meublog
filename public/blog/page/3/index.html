
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Meu Blog, by Andre Fonseca</title>
  <meta name="author" content="Andre Fonseca">

  
  <meta name="description" content="Esse é daqueles posts que escrevo para não esquecer algumas coisas.  Nessa semana precisei colocar um job no cron do meu sistema para que ele &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.andrefonseca.net/blog/page/3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Meu Blog, by Andre Fonseca" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Meu Blog, by Andre Fonseca</a></h1>
  
    <h2>Pensamentos, opiniões e alguns estudos</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.andrefonseca.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/05/26/colocando-uma-tarefa-no-cron/">Colocando Uma Tarefa No Cron</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-26T00:00:00-03:00" pubdate data-updated="true">May 26<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">Esse é daqueles posts que escrevo para não esquecer algumas coisas.  Nessa semana precisei colocar um job no cron do meu sistema para que ele apagasse todos os arquivos que foram criados a mais de X minutos. Esse job deveria rodar de 10 em 10 minutos.  A linha ficou assim:

[cc lnag=&#8221;bash&#8221;]
*/1 * * * * for name in `find /opt/participacoes/uploads/videos  -name &#8216;*&#8217; -type f  -cmin +3 -print`; do echo $name; rm -f $name ; done &gt; /dev/null 2&gt;&amp;1
[/cc]

Essa linha pega todos os arquivos dentro de uma pasta e joga seus nomes numa lista. Essa lista é lida no loop e o comando de remove é feito.  Uma coisa interessante nessa lista é que só pega arquivos regulares, tudo isso graças a opção -type f. Você pode ver mais  opções digitando

[cc lang=&#8221;bash&#8221;]
man find
[/cc]

Outro detalhe legal dessa linha é como você define o intervalo de tempo para execução de algo no cron. No cron, funciona da seguinte forma:  A B C D E  onde cada um é: 
<ul>	
<li> A - o minuto no qual quer que seu job execute. Ex: 0 ou 30 </li>
<li>B - hora</li>
<li>C - dia</li>
<li>D - mes</li>
<li>E - ano </li>
</ul>

Se caso queira fazer algo como intervalo de tempo (quero que algo rode a cada 10 minutos) você pode usar */10(intervalo de tempo).

Existe ainda a opção de usar alias especiais do tipo @daily. Para mais informação, peça ajuda ao google ou ao man na sua linha de comando.  

Uma última coisa é que estou jogando a saída da execução para o dev/null (para o limbo - lugar nenhum).  Assim eu não fico com alertas e saidas indesejadas. 
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/05/23/instalando-o-nodejs-e-npm/">Instalando O NodeJS E Npm</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-23T00:00:00-03:00" pubdate data-updated="true">May 23<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">A um tempo comecei a brincar com NodeJS.  Peguei uma aplicação que tinha feito em Sinatra e resolvi que a reescreveria em NodeJS: primeiro pelo aprendizado e depois por causa da natureza da aplicação ficar bem com uma arquitetura de push.

Primeiro passo é instalar tudo que você precisa para desenvolver com NodeJS&#8230; NodeJS e NPM. O npm é um gerenciador de pacotes &#8220;semelhante&#8221; ao rubygem/pypi. A dica inicial é esquecer tutoriais que ensinam a instalar via script (curl &#8230;. ), apt gets, ports ou brew&#8230; A melhor forma é clonar o repositório de cada um (NodeJS e NPM) e executar os comandos sugiros no README:

[cc lang=&#8221;bash&#8221;]
git clone https://github.com/joyent/node.git
cd node
./configure
make
make install
[/cc]

Com  isso ele irá verificar as depencias necessária para ele funcionar e listá-las. Caso algo ele indique que deve instalar algo, busque o pacote no google e veja como instalar. Para ubuntu é fácil um apt-get resolve, para outros um yum install, etc.

Repita a mesma coisa para o NPM

[cc lang=&#8221;bash&#8221;]
git clone https://github.com/isaacs/npm.git
cd npm
sudo make install
[/cc]

Para instalar seus pacotes para desenvolver com NodeJS basta agora ir na linha de comando e digitar <em>npm install &lt;nome do pacote&gt;</em> . Isso irá instalar o pacote. OBS: O npm por padrão instala os pacotes dentro do diretório corrente algo como node_modules. Assim caso queira que os pacotes seja instalados globalmente, ou seja, para toda a máquina, use o -g ou &#8211;global junto com o comando install.

Dentro do <a href="http://blog.nodejs.org/2011/05/01/npm-1-0-released/">blog do node</a>, tem uma excelente explicação de como fazer, sendo que você deve reter o seguinte para o início.  Ao instalar algo no  global, você estará instalando na pasta : &#8220;/usr/local/lib/node_modules&#8221;.  Depois disso, caso queira que essa biblioteca esteja acessível dentro do seu projeto, você deve criar um link para esse global. Para isso:

[cc lang=&#8221;bash&#8221;]
cd seu_projeto
npm link <nome do pacote>
[/cc]

Isso irá criar um link dentro da pasta local node_modules para a pasta global do pacote. E voilá !
Muito obrigado ao Emerson Macedo (codificando.com ou codificando.org) pela ajuda.

Pronto, para o começo está de bom tamanho. Assim que for avançando com a APP vou postando as escolhas e as descobertas.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/05/12/setup-ambiente-ruby-instalando-homebrew-e-git/">Setup Ambiente Ruby - Instalando Homebrew E Git</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-12T00:00:00-03:00" pubdate data-updated="true">May 12<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">Uma das coisas que mais admiro no Ubuntu é o sistema de gerenciamento de pacotes. Instalar, atualizar, desinstalar, etc no Ubuntu é tão simples quando uma comanda no console: &#8220;sudo apt-get install&#8221;. O problema é que para outros sistemas operacionais, como o MacOs isso não é tão simples. Na Globo.com, fui apresentado ao <a href="https://github.com/mxcl/homebrew/wiki/installation">homebrew</a>. Ele é muito legal, tem muitas formúlas(receitas de instalação) e é fácil de gerenciar e manter. Para instalar:

[cc lang=&#8221;bash&#8221;]
ruby -e &#8220;$(curl -fsSLk https://gist.github.com/raw/323731/install_homebrew.rb)&#8221;
[/cc]

Para instalar algumas bibliotecas, o brew, por algumas vezes usa, no caso do MacOS, o pacote XCode para compilar. Assim, você terá que instalar o XCode no seu sistema. Se tem o cd original do seu mac, ele estará lá para instalar. Caso não tenha, você pode usar a AppStore do Mac para instalar.
Existem caminhos alternativos para instalá-lo. Mas não recomendo.
Uma vez que tenha instalado o homebrew na sua máquina com sucesso, para usá-lo basta usar o comando brew. Teste no seu console e ele deverá ter uma saída semelhante a:
[cc lang=&#8221;bash&#8221;]
andre.fonseca@pimpao-computer ~/projects/participacoes/puppet/deploy $ brew
Usage: brew [-v|&#8211;version] [&#8211;prefix [formula]] [&#8211;cache [formula]]
[&#8211;cellar [formula]] [&#8211;config] [&#8211;env] [&#8211;repository]
[-h|&#8211;help] COMMAND [formula] &#8230;

Principal Commands:
install formula &#8230; [&#8211;ignore-dependencies] [&#8211;HEAD]
list [&#8211;unbrewed|&#8211;versions] [formula] &#8230;
search [/regex/] [substring]
uninstall formula &#8230;
update

Other Commands:
info formula [&#8211;github]
options formula
deps formula
[/cc]

Bom agora temos uma excelente ferramenta para instalarmos as coisas de forma simples, para montarmos nosso setup. A segunda coisa sem a qual eu não acho que tenhamos um ambiente completo é o Git. O git é um controle de versão descentralizado. Se você não está familiariado com ele, sugiro que estude, pois isso irá mudar completamente a sua forma de ver controles de versões. Acredito que já alguns post meus sobre o assunto, caso não aguarde e peçam ajuda ao google.
Voltando, vamos instalar o git em nossa máquina e assim começar. Para isso use o comando:
[cc lang=&#8221;bash&#8221;]
brew install git
[/cc]
Isso é tudo. Agora você já tem todo o git funcionando na sua máquina. Eu também gostou muito de colocar alguns atalhos para o git, para isso, eu adiciona &#8220;alias&#8221; no meu arquivo de bash_profile, desse jeito:

[cc lang=&#8221;bash&#8221;]
echo alias gpush=&#8221;git push origin master&#8221; &gt; ~/.bash_profile
echo alias gpull=&#8221;git pull origin master&#8221; &gt; ~/.bash_profile
echo alias gst=&#8221;git status&#8221; &gt; ~/.bash_profile
echo alias gcm=&#8221;git commit -am &#8221; &gt; ~/.bash_profile
echo alias gcko=&#8221;git checkout &#8221; &gt; ~/.bash_profile
[/cc]

Para o começo ficamos por aqui. No próximo post mostrarei como instalar o RVM e gems para o seu projeto. No github do projeto tem um bom tutorial indicando como fazer. Para facilitar faça o comando abaixo no seu terminal:
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/05/06/script-para-organizacao-das-minhas-fotos/">Script Para OrganizaÃ§Ã£o Das Minhas Fotos</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-06T00:00:00-03:00" pubdate data-updated="true">May 6<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">A pouco tempo atrás comprei um novo computador pois meu antigo estava a &#8220;beira da morte&#8221;.  Antes, como bom geek que sou, resolvi fazer um backup de todos os meus arquivos pessoais para garantir, principalmente minhas fotos - o risco de vida é grande pois a esposa é bem brava.  Confesso que não elaborei muito para fazer o backup: fiz uma cópia simples de todos meus arquivos da pasta para um HD externo que tenho.  Não organizei. Nada. Só copiei e ponto final.

Após a chegada do novo computador, montado  e o Ubuntu 11.04 instalado no novo computador (o pessoal insiste em mandar coisas com o SO Windows já instalado mas isso é papo para outro post), resolvi dar uma olhada no backup e organizar principalmente minhas fotos que estavam uma verdadeira zona: fotos de assuntos diferentes na mesma pasta, tudo misturada, etc.

Como programador que sou decidi que iria arrumar algo que pudesse fazer isso de forma automatizada. A primeira tentativa foi buscar no google por alguma ferramenta gratuita que já fizesse isso porém logo desisti. Já venho um tempo estudando Shell Script e Bash e depois de um twitter do conhecido Marcos Tapajós, resolvi que iria fazer isso por script.. até porque não achei ferramentas para fazer do jeito que eu queria.

Passei a buscar como faria esse script, pois a minha idéia era de pegar todos as minhas fotos que estavam espalhadas por várias pastas e arrumá-las agrupando-as por ano, mês e dia.  Confesso que pensei em fazer algo programa em Python ou Ruby ou Groovy para resolver meu problema, entretanto, cismei que deveria fazer isso em shell script pelo aprendizado e por acreditar que seria mais rápido e simples.

Pedi ajuda a uma pessoa do meu trabalho que está na equipe que cuida da infra da Globo.com (Magno) e ele me deu a dica de alguns sites que tinham exatamente o que eu queria. Sendo bem sincero bastou ir no google e digitar : organize photo shell script, que apareceu vários que faziam oque eu queria. Assim, resolvi escrever esse post para passar adiante (em português)  o script que fiz baseado no que eu encontrei e com o passo a passo (não encontrei nada em português - provavelmente erro meu).

Vamos lá. Primeiro você tem que instalar a biblioteca que nos ajudará nessa tarefa. Estou usando o ExifTools.  Busque por isso no google e verá bons tutoriais para instalar. Como eu uso Ubuntu foi bem fácil, bastou usar o comando:

[cc lang=&#8221;bash&#8221;]
sudo apt-get install libimage-exiftool-perl
[/cc]

Uma vez que eles esteja instalado, crie um arquivo para o seu script:

[cc lang=&#8221;bash&#8221;]
touch organiza_fotos.sh
vim organiza_fotos.sh
[/cc]

Agora com o editor aberto é só copiar e colar o código abaixo:
[cc lang=&#8221;bash&#8221;]
#!/bin/sh

from=/media/Externo/minhas_imagens
to=/media/Externo/fotos_organizadas
find $from -iname &#8216;*jpg&#8217; | while read FILENAME
do
year=`exiftool &#8220;$FILENAME&#8221;  | awk &#8216;/Date\/Time Original/ {print $4}&#8217;|cut -f1 -d&#8217;:&#8217;`
month=`exiftool &#8220;$FILENAME&#8221;  | awk &#8216;/Date\/Time Original/ {print $4}&#8217;|cut -f2 -d&#8217;:&#8217;`
day=`exiftool &#8220;$FILENAME&#8221;  | awk &#8216;/Date\/Time Original/ {print $4}&#8217;|cut -f3 -d&#8217;:&#8217;`
target=$to/$year/$month/$day
mkdir -p $target
cp &#8220;$FILENAME&#8221; $target
echo &#8220;Moved $FILENAME to $target&#8221;
done
[/cc]

&nbsp;

Veja que existe duas variáveis que terá que editar, uma, a primeira, e de onde ele buscará as fotos; a segunda qual será o caminho base para onde as fotos organizadas serão copiadas.

Depois é executar o seu shell e ver a mágica acontecer. Pronto. Um script para organizar as sua fotos.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/05/06/postando-fotos-no-picasa-pela-linha-de-comando/">Postando Fotos No Picasa Pela Linha De Comando</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-06T00:00:00-03:00" pubdate data-updated="true">May 6<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">Creio que depois de ler o meu último post, todo mundo já está com suas fotos arrumadinhas. Sendo assim é hora de compartilhá-las com seus amigos. Eu uso o Picasa para isso pois gosto dele e sempre me atendeu bem. Muitos amigos dizem que o Flickr é melhor mas prefiro meu bom e satisfatório picasa. Muitos fariam é baixar o picasa desktop (nem sei se tem para o Ubuntu) e a partir dele iriam organizar suas fotos e montar seus albuns e por fim, publicá-los na grande rede.

Como, se lembrarem bem do último post,  eu estou afim de me aprimorar no uso do console, principalmente, em Bash, resolvi pedir novamente &#8220;ajuda&#8221; ao google e busquei por envio por linha de comando. Para minha grata surpresa, o pessoal da própria google disponibiliza um<a title="googlecl" href="http://code.google.com/p/googlecl/"> google command line</a> para diversos de seus produtos incluido o picasa.  Por enquanto só funciona para os que tem gdata (disclamer traduzido do próprio site do googlecl)

Para instalá-lo, no Ubuntu, é bem simples:
[cc lang=&#8221;bash&#8221;]
sudo apt-get install googlecl
[/cc]

Pelo que eu entendi ele na verdade é uma biblioteca python por isso nos outros sistemas operacionais deve bastar instalar via pip
[cc lang=&#8221;bash&#8221;]
pip install googlecl
[/cc]

Não sei dizer se com isso, instalando via pip, você perder o binário - comando - para usar.
Uma vez instalado é só alegria e usar:
[cc lang=&#8221;bash&#8221;]
andre@vermelhinho:~$ google help
Welcome to the Google CL tool!
Commands are broken into several parts:
service, task, options, and arguments.
For example, in the command
&#8220;&gt; picasa post &#8211;title &#8220;My Cat Photos&#8221; photos/cats/*&#8221;
the service is &#8220;picasa&#8221;, the task is &#8220;post&#8221;, the single
option is a title of &#8220;My Cat Photos&#8221;, and the argument is the
path to the photos.

The available services are
&#8216;picasa&#8217;, &#8216;blogger&#8217;, &#8216;youtube&#8217;, &#8216;docs&#8217;, &#8216;contacts&#8217;, &#8216;calendar&#8217;, &#8216;finance&#8217;
Enter &#8220;&gt; help &#8221; for more information on a service.
Or, just &#8220;quit&#8221; to quit.
andre@vermelhinho:~$
[/cc]

E para enviar suas foto fica mais ou menos assim:
[cc lang=&#8221;bash&#8221;]
google picasa create &#8220;Cat Photos&#8221; ~/photos/cats/*.jpg
[/cc] 
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/04/20/voce-realmente-esta-testando/">VocÃª Realmente EstÃ¡ Testando?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-20T00:00:00-03:00" pubdate data-updated="true">Apr 20<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">Na maioria dos livros que li nos últimos tempos do mais diversos assuntos ligados a engenharia de software, testes automatizados, e mais especificamente, TDD (test driven development) e BDD (behavior driven development) são dominantes. É certo que, atualmente, se desejamos ter qualidade e velocidade de entrega nos nosso produtos precisamos de testes automatizados. E vou além: digo que abordagens como TDD e BDD auxiliam o desenvolvedor a escrever código melhor e mais focado no valor para o cliente.

A questão é que se estabeleceu axiomas - verdades absolutas - onde para ser bom o projeto precisa ter 100% de cobertura de código e  ter testes unitários e testes de integração e testes de aceitação (tela e feature), etc.  Isso nem sempre é verdade e pode ser um verdadeiro &#8220;tiro no pé&#8221;. Antes de mais nada é preciso entender a real função do teste.  E qual será a melhor forma de utilizá-lo.  Não estou discutindo aqui abordagens e sim se estamos usando de forma inteligente e consciente os testes.

Em uma conversa recente com <a href="http://blog.heynemann.com.br/">Bernardo Heynemann</a>, vimos, que, por exemplo, em alguns casos testes de aceitação que usavam Cucumber ou Pyccuracy, estavamos testando mais o navegador que a funcionalidade em si. Quando falamos de cobertura temos outro ponto interessante: 100% não é garantia de nada. Já ouvi falar  de sistemas com 100% de cobertura que quando foram fazer refactoring - confiando na cobertura de testes,  &#8221;quebrou&#8221; tudo ao colocar em produção pois vários detalhes escaparam.  Isso porque, provavelmente existiam diversos testes que faziam &#8220;nada&#8221; e que ali estavam apenas para garantir a cobertura mínima.

Novamente citando <a href="http://blog.heynemann.com.br/">Bernardo Heynemann</a>, ele me disse que para os que estão começando, é importante seguir uma fórmula:  testes unitários, testes de integração, testes de aceitação, etc. Isso porque ainda estão formando sua base de experiência e tem pouco discernimento para saber quais seriam os pontos críticos a serem testados para termos a garantia de qualidade.  Mas a medida que for ganhando bagagem e aguçando seu senso crítico, é importante se questionar o que testar, como testar, etc.

Uma coisa que sempre falo é que testar da trabalho. Por mais que possa trazer benefícios, ainda é mais trabalho. Se falamos de testes automatizados - programáticos - é mais linha de código. Por exemplo, tiveram coisas que levei mais tempo escrevendo os testes do que implementando.  Teste onera sim.

Antes de mais nada quero esclarecer que não sou contra testes. Muito pelo contrário, acredito que não existe a possibilidade de fazer algo bem sem usar TDD ou BDD. A questão que levanto é o quanto estamos realmente testando nossos sistemas e o quanto estamos apenas &#8220;inventando&#8221; para cumprir com regras pré-definidas que ninguém de fato entendeu para que servem.

Um exemplo disso que estou falando é quando temos diversos níveis de teste em nossa aplicação &#8230; E testamos a mesma coisa em todos eles. Sabe aquele teste que você fica criando o Model, colocando os dados  no banco, acessando o banco, etc? Isso mesmo. É um bom smell disso que estou falando.

Uma coisa que faço é primeiro me concentrar no objetivo que quero atingir com aquele teste. Tudo mais é superfluo e logo pode ser ignorado(entenda mock e outras tecnicas).  Logo, se quero testar as chamadas do controller de minha aplicação, eu não preciso, nem quero me preocupar com que está acontecendo dentro do Model associado.   Outro ponto é se já testei algo em algum ponto, evito ficar testando novamente&#8230; Se por acaso isso for necessário é sinal que preciso fazer um refactoring no meu código.

Em futuro artigos pretendo trazer o assunto e ir mais fundo inclusive trazendo exemplos, trechos de código, etc.  Até a próxima.

&nbsp;

&nbsp;

&nbsp;
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/04/10/evento-flisol-e-devinrio-2011/">Evento Flisol E Devinrio 2011</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-10T00:00:00-03:00" pubdate data-updated="true">Apr 10<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">Esse final de semana rolou o Flisol. O Flisol  é um evento de software livre. Fugindo da agenda comum de instalações e evangelizações, o pessoal da UniRio inovou mais uma vez e montou uma grade de palestras ampla e muito legal. Eu tive o prazer, junto com o Guilhermes Souza, de ser um dos palestrantes, onde falei de Código Legado abordando bem a questão de engenharia de software.

Durante o evento também tivemos a oportunidade de fazer uma reunião de trabalho sobre o DevinRio 2011 e posso dizer de agora que queremos continuar mantendo o nível e superá-lo.  Para dar um gostinho gravamos alguns depoimentos do pessoal que foi ao evento no sábado dizendo porque deve ir no DevinRio desse ano. Vale a pena conferir. Peço desculpas por faltar nome de alguns mas esse amigo aqui esqueceu de anotá-los. Obrigado  a todos.

&nbsp;
<iframe src="http://player.vimeo.com/video/22216448?color=59a5d1" width="600" height="450" frameborder="0"></iframe><p><a href="http://vimeo.com/22216448">Por que voce deve ir ao DevinRio 2011</a> from <a href="http://vimeo.com/user2993643">andre fonseca</a> on <a href="http://vimeo.com">Vimeo</a>.</p><p>Depoimentos do pessoal no Flisol falando porque você deve ir no DevinRio desse ano</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/04/09/valor-para-o-cliente/">Valor Para O Cliente</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-09T00:00:00-03:00" pubdate data-updated="true">Apr 9<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p align="justify">Numa conversa recente com alguns colegas do trabalho falamos sobre a questão onde o programador, amante de tecnologia, tende a esquecer alguns aspectos comerciais daquilo que ele está fazendo. </p> <p align="justify">Qual de nós não quiz aquela oportunidade para usar a mais nova versão daquela biblioteca no seu projeto e ouviu um sonoro não do coordenador ou gerente ou qualquer outro que seja? Quem nunca ficou mega empolgado fazendo um mega refactoring no código e depois de mostrou para algum amigo a sua proeza onde um emanharado de coisas ficou mais compreensível ou melhor arquitetado? </p> <p align="justify">Nós desenvolvedores por natureza, espero que a maioria, somos apaixonado por tecnologia. Tanto que acreditamos que isso seja a única razão de nossa existencia e esquecemos com frequencia qualquer coisas. Pois todo o resto é um mero coadjuvante da tecnologia. </p> <p align="justify">A questão que isso dentro do nossos produtos, os quais estamos sendo pagos para fazer ou pretendemos ganhar dinheiro com ele acaba, em muitos casos, atrapalhando. Eu mesmo sou um exemplo disse: por várias vezes gastei um tempo considerável dentro de uma tarefa fazendo um reestudo e redesing sendo que poderia ter focado mais na entrega do valor ao cliente naquele momento. </p> <p align="justify">Poucos de nós tem em mente que o foco princípal de nosso atividade é cliente satisfeito. Criamos parametros de medidas e raríssimos são aqueles que levam em conta se estamos ou não entregando mais ou menos valor. Isso até mesmo dentro de toda essa hype de ágil. </p> <p align="justify">Temos métrica para dizer cobertura de testes; temos métricas para dizer o quanto nosso código é claro; verificar duplicidades; mas não nos preocupamos se no final o cliente está feliz (imaginaram um gráfico no quadro com o humor do cliente por entrega?)</p> <p align="justify">Antes que pensem que penso que devemos é fazer as coisas de qualquer jeito e entregar pois isso é o importa para o cliente e ponto final … Bom senso é a palavra chave da mensagem que quero passar para vocês. </p> <p align="justify">BOM SENSO</p> <p align="justify">O grande segredo que devemos perseguir é encontrar o equilíbrio ideal entre entregar valor o quanto antes possível para o cliente sem abrir mão de qualidade. </p> <p align="justify">Já vi milhares de pessoas adotaram tática de 100% de cobertura, políticas severas de escritura de código(exemplo: proíbido usar if) e isso depois virar um mega gargalo nas entregas. Ter código claro e bonito é legal, desde que isso ajuda a gente a atender o cliente pois é ele que nos paga. </p> <p align="justify">Minha mãe sempre me dizia na minha infância: </p> <blockquote> <p align="justify">O ótimo é o inimigo do bom</p></blockquote> <p align="justify">Temos que ter cuidado com esse nosso lado Geek de ser e dar uma suavizada nessa tendencia de só pensar na parte técnica da coisa e passarmso a ter uma visão total do produto. Depois disso, usar essa visão para definir o quão fundo vale a pena refatorar aquele código. </p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/04/08/mais-uma-do-solr-dynamic-fields/">Mais Uma Do SOLR - Dynamic Fields</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-08T00:00:00-03:00" pubdate data-updated="true">Apr 8<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content">Como alguns que acompanham o blog já devem ter percebido, eu estou usando o SOLR em um projeto. O SOLR é um servidor Web de busca, feito em cima do Lucene (grupo Apache). Ele é realmente poderoso e simples de usar. Recomendo muito para quem precisa fazer buscar textuais pesados e que tem uma quantidade razoável de documentos/dados para indexar.  Como minha aplicação é Rails, estou usando uma GEM, chamada Sunspot, que serve de DSL (facilitador) nessa &#8220;conexão&#8221; entre minha app e o SOLR.

Nesse dias surgiu a necessidade de fazer uma nova feature em nosso sistema que parece ser bem simples mas como busco pelo SOLR a coisa ganhou bastante complexidade.Só para que entendam o problema, deixe me contextualizá-los.  Minha aplicação é uma ferramenta de seleção de pessoas - CASTING. Nela um administrador cria uma campanha e define um formulários com N perguntas que serão respondido pelo candidato. Ao finalizar o preenchimento, esse formulário vira um inscrições e salvamos suas respostas.  Surgiu então a necessidade de buscarmos por inscrições através de valores de respostas a perguntas específicas:  Quero buscar por todas as inscrições que responderam Vasco para a pergunta &#8220;Qual é o seu time do coração?&#8221;.

Muitos, se não considerarmos que estamos usando o SOLR e que vamos fazer essa pesquisa direto no banco de dados, vão dizer é a solução bem simples: Se resume a um query onde informo o campo e o valor de resposta desejado. Tendo isso busca pelas inscrições que tenha aquela resposta. Simples, não é? Nem tanto. O meu cliente deseja que isso esteja integrado aos demais filtros já existentes - idade, sexo, estado, status, etc.

Bem antes desse nova funcionalidade, a busca direto no banco, dado a quantidade de dados, já se mostrou inviável. Logo, sem chances de eu largar o SOLR e voltar para o banco ou tentar fazer algo híbrido.

Parte para tentar descobrir se existia algo dentro do universo do SOLR e/ou do Sunspot onde eu pudesse definir um campo do indice de forma dinâmica, ou seja, para cada instancia que for criando. Depois de um certo tempo gasto com o Oráculo (Google) , fiquei feliz que mais uma vez nem a gem nem o servidor me decepcionou.

O Sunspot tem um recurso que é o &#8220;dynamic field&#8221; que é o seguinte: todo o indice de sua classe é feito no build da classe, ou seja, no seu load.  Como precisava definir coisas que só existiriam no contexto da instância, eu precisa de algum recurso que me permitisse delegar a criação de alguns campos nesse momento de indexação (instancia). Esse recurso de &#8220;dynamic&#8221; é exatamente isso: ele  configura um bloco que será criado quando ele for indexar. Com isso eu pude buscar no SOLR por campos que só existem para algumas inscrições.

Em termos de código é mais ou menos o seguinte. Imagine que sua Inscricao tenha uma relação has_many com Resposta.

class Inscricao &lt;&lt; ActiveRecord

has_many :repostas

end

A classe Resposta faz referencia a um campo de seu formulário. Logo a busca terá como nome do campo do indice o campo + id e seu valor será a resposta. Assim o mapeamento fica:

&#8230;

searchable do

dynamic :respostas do

respostas.inject({}) do |mapa, resposta|

mapa.merge({ resposta.campo.id.to_sym =&gt; resposta.valor})

end

end

end

&nbsp;

Com isso acima, fica pronto a configuração. Para busca fica assim:

search do

dynamic :respostas do

with(:1, &#8220;teste&#8221;)

end

&#8230;

Assim estou buscando por Inscrições cujo a resposta a pergunta 1 foi teste. E pronto. A mágica foi feita.

Espero sinceramente que isso ajuda alguém como outros blogs que consultei me ajudaram. Fiquem em paz e até a próximo.
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/31/usando-solr-parte-2-testes-e-cucumber/">Usando SOLR Parte 2 - Testes E Cucumber</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-31T00:00:00-03:00" pubdate data-updated="true">Mar 31<span>st</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><!-- p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica} p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px} -->Se você já leu a primeira parte dessa série, você até o momento tem as gems necessárias instaladas e parte do seu ambiente resolvido.  Uma coisa acabou ficando esquecida, e quem tentou implementar algo seguindo os passos que falei e fez algum teste deve ter enfrentado bastantes erros, dentre eles o de que não foi possivel encontrar constantes e o método searching.

Isso tudo acontece pois esquecemos de fazer o require das libs dentro das nossas classes. Isso porque, como não fizemos dentro do enviroments(isso só vale para apps Rails) as chamadas das libs, o Rails ainda não sabe como achar as coisas.

Bem vamos lá. Imaginemos que você quer que a classe Minha seja indexa e posteriormente busca pelo SOLR, basta colocar no top o require:

require &#8216;sunspot&#8217;

require &#8216;sunspot_rails&#8217;

Feito isso e mais os passos já descritos, creio que agora já temos algo funcional.

Bem vamos para a parte de testar a coisa. Claro que todos nós somos adeptos do TDD (Test Driven Development - Desenvolvimento Orientado a Testes) e por isso vamos sempre querer escrever nossas especificações antes. Falei especificações pois considero que você seja uma pessoa experta e esteja usando o RSPEC.

Para isso, como disse na parte 1, é preciso que você use alguns matchers que irão facilitar em muito a sua vida. Eles estão dentro da gem sunspot_matchers. Dentro do seu spec_helper (isso já vale para todo projeto ruby que esteja usando o Rspec), coloque as linhas:

&nbsp;

require &#8216;sunspot_matchers&#8217;

&#8230;

config.include SunspotMatcher

&#8230;

config.before do

Sunspot.session = SunspotMatchers::SunspotSessionSpy.new(Sunspot.session)

end

&nbsp;

config.after do

Sunspot.session = Sunspot.session.original_session

end

Estamos fazendo aqui (acredito que já tenho dito isso) é colocando uma interceptador das chamadas da DSL a sessão com o SOLR para ver se tudo está ocorrendo do jeito que queremos. Seria algo como o nosso mocka, para quem conhcece.

Segue abaixo um exemplo de um código de teste. Veja como fica bem simples testar se a busca, no caso, está incluindo os itens que preciso para fazer a filtragem:

&#8230;

it &#8220;Deve filtrar pela data de finalizacao maior que&#8221; do

data = DateTime.now.strftime(&#8220;%d/%m/%Y&#8221;)

encontrados = Inscricao.busca({:campanha_id =&gt; &#8220;1&#8221;, :start_date =&gt; data})

data = Date.strptime(data, &#8216;%d/%m/%Y&#8217;)

Sunspot.session.should be_a_search_for(Inscricao)

Sunspot.session.should have_search_params(:with, Proc.new { with(:finalizada_em).greater_than(data)})

end

&nbsp;

it &#8220;Deve filtrar pela data finalizacao menor que&#8221; do

data = DateTime.now.strftime(&#8220;%d/%m/%Y&#8221;)

encontrados = Inscricao.busca({:campanha_id =&gt; &#8220;1&#8221;, :end_date =&gt; data})

data = Date.strptime(data, &#8216;%d/%m/%Y&#8217;)

Sunspot.session.should be_a_search_for(Inscricao)

Sunspot.session.should have_search_params(:with, Proc.new { with(:finalizada_em).less_than(data)})

end

&nbsp;

it &#8220;Deve filtrar pela data de nascimento maior que&#8221; do

data = Date.today.years_ago(20)

encontrados = Inscricao.busca({:campanha_id =&gt; &#8220;1&#8221;, :idade_final =&gt; &#8220;20&#8221;})

Sunspot.session.should be_a_search_for(Inscricao)

Sunspot.session.should have_search_params(:with, Proc.new { with(:data_nascimento).greater_than(data)})

end

&nbsp;

A coisa fica bem próxima as expectations que estamos acostumados a usar.  Com isso temos nossos testes de especificação prontos e podemos então passar para os teste de aceitação.

Antes que alguém comece a dizer que estou &#8220;roubando&#8221; pois estou fazendos os testes de aceitação depois de já ter algo implementado, quero dizer que sou adepto da abordagem emergente. Vou implementado os testes a medida da necessidade - isso é o que chamam de inside out.

Imagino que você que esteja lendo e desenvolvendo junto comigo deva usar o Cucumber para fazer os seus testes de aceitação. Também imagino que, ao contrário dos testes de especificação ou microtestes, você agora queira que as coisas estejam rodando a vera.

Para ter um SOLR funcionando para você executar os seus testes de Cucumber, vá no arquivo, features/support/env.rb e coloque as seguintes linhas:

&#8230;.

&nbsp;

::Sunspot::Rails::Server.new.start

&nbsp;

Before do

Inscricao.reindex

end

&nbsp;

After do

Inscricao.remove_all_from_index!

end

&nbsp;

at_exit do

puts &#8220;Saindo do solr&#8221;

::Sunspot::Rails::Server.new.stop

end

&nbsp;

Essas linhas irão iniciar um SOLR; a cada teste pedir para reindexar os dados neles e por fim, quando tudo terminar, ele irá parar o solr que você iniciou.  Uma breve ressalva:  tive um mega problema&#8230; quando fiz isso, meus teste de jeito algum passavam. Isso porque, por motivos que ainda não sei, quando criamos na mão nossos arquivos, precisamos pedir que sejam indexados, ou seja,  ele não indexa automaticamente. Pelo oque li a gem faz isso pelos controllers. Assim que tiver certeza sobre isso escrevo algo. A questão é que tive que escrever um maldito passo para indexar e chamá-lo toda vez que algo era criado. Algo como abaixo:

&nbsp;

Dado /ˆque preciso reindexar minhas coisas$/ do

Minhas.reindex

end

&nbsp;

&#8230; Em um features da vida

Dado que crio uma coisa minha

E que preciso reindexar minhas coisa

Eu vejo essa coisa na busca

&#8230;

&nbsp;

Bem pessoal por hoje é só. Em outras oportunidades pretendo escrever sobre como você pode colocar tudo isso de forma assíncrona e outros truques bem legais, bem como buscas complexas e montagens de indices.

&nbsp;
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/03/04/onde-buscar/">Não precisa saber tudo mas o onde buscar sim.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/29/como-ver-a-ultima-tag-que-foi-criada-no-git/">Como ver a última tag que foi criada no git</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/22/cada-um-tem-que-saber-seu-papel-e-sua-responsabilidade/">Cada um tem que saber seu papel e sua responsabilidade.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/12/08/confie-na-sua-intuicao-e-nao-seja-teimoso/">Confie na sua intuiÃ§Ã£o e nÃ£o seja teimoso.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/11/25/customizando-a-renderizacao-do-template-de-form-do-admin-do-django/">Customizando a renderizaÃ§Ã£o do template de form do admin do Django</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/aoqfonseca">@aoqfonseca</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'aoqfonseca',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("aoqfonseca", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/aoqfonseca" class="twitter-follow-button" data-show-count="false">Follow @aoqfonseca</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Andre Fonseca -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
